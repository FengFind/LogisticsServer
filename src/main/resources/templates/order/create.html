<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- BEGIN HEAD -->
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> 
    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/font-awesome/css/font-awesome.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/simple-line-icons/simple-line-icons.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap/css/bootstrap.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css"
          rel="stylesheet" type="text/css"/>
    <!-- END GLOBAL MANDATORY STYLES -->
    <!-- BEGIN THEME GLOBAL STYLES -->
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/css/components.min.css"
          rel="stylesheet" id="style_components" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/css/plugins.min.css"
          rel="stylesheet" type="text/css"/>
    <!-- END THEME GLOBAL STYLES -->
    <!-- BEGIN THEME LAYOUT STYLES -->
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/layout4/css/layout.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/layout4/css/themes/default.min.css"
          rel="stylesheet" type="text/css" id="style_color"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/layout4/css/custom.min.css"
          rel="stylesheet" type="text/css"/>
    <!-- END THEME LAYOUT STYLES -->

    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css"
          rel="stylesheet" type="text/css"/>
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-sweetalert/sweetalert.css"
          rel="stylesheet" type="text/css"/>
    <!-- END PAGE LEVEL PLUGINS -->

    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css"
          rel="stylesheet" type="text/css"/>
    <!--城市插件样式-->
    <link href="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/city-picker/css/city-picker.css" rel="stylesheet" type="text/css"/>
	
	
</head>
<!-- END HEAD -->
<!-- BEGIN PAGE HEAD-->
<div class="page-head">
    <div class="row">
        <div class="col-md-12">
            <div class="portlet light bordered">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-equalizer font-blue-hoki"></i>
                        <span class="caption-subject font-blue-hoki bold uppercase">创建运单</span>
                    </div>
                </div>
                <div class="portlet-body form" id="form">
                    <!-- BEGIN FORM-->
                    <div class="horizontal-form" novalidate="novalidate">
                        <div class="">
                            <h5 class="form-section"> <i class="fa fa-send"></i> 发货人信息</h5>
                            <div class="row">
                                
                                
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('send_name')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'is-danger': errors.has('send_name') }" name="send_name" type="text" placeholder="输入发货人姓名" v-model="order.send_name">
                                        <label for="send_name">姓名<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('send_name')?errors.first('send_name'):'输入发货人姓名...'}}</span>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('send_phone')}">
                                        <input v-validate="'required|numeric'" :class="{'form-control': true, 'is-danger': errors.has('send_phone') }" name="send_phone" type="text" placeholder="输入发货人手机号" v-model="order.send_phone">
                                        <label for="send_phone">手机号<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('send_phone')?errors.first('send_phone'):'输入发货人手机号...'}}</span>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('send_addr')}">
                                        <input v-validate="'required'" :class="{'form-control': true }" name="send_addr" type="text" placeholder="输入发货人地址" v-model="order.send_addr"  data-toggle="city-picker">
                                        <label for="send_addr">发货地<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('send_addr')?errors.first('send_addr'):'输入发货人地址...'}}</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('send_addr_info')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'is-danger': errors.has('send_addr_info') }" name="send_addr_info" type="text" placeholder="输入发货人详细地址" v-model="order.send_addr_info">
                                        <label for="send_addr_info">详细地址<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('send_addr_info')?errors.first('send_addr_info'):'输入发货人详细地址...'}}</span>
                                    </div>
                                </div>     
                            </div>

                            <h5 class="form-section"><i class="fa fa-reply"></i> 收货人信息</h5>
                            <div class="row">
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('recive_name')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'is-danger': errors.has('recive_name') }" name="recive_name" type="text" placeholder="输入收货人姓名" v-model="order.recive_name">
                                        <label for="recive_name">姓名<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('recive_name')?errors.first('recive_name'):'输入收货人姓名...'}}</span>
                                    </div>
                                </div>
                                
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('recive_phone')}">
                                        <input v-validate="'required|numeric'" :class="{'form-control': true, 'is-danger': errors.has('recive_phone') }" name="recive_phone" type="text" placeholder="输入收货人手机号" v-model="order.recive_phone">
                                        <label for="recive_phone">手机号<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('recive_phone')?errors.first('recive_phone'):'输入收货人手机号...'}}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('recive_addr')}">
                                        <input v-validate="'required'" :class="{'form-control': true}" name="recive_addr" type="text" placeholder="输入收货人地址" v-model="order.recive_addr" data-toggle="city-picker">
                                        <label for="recive_addr">收货地<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('recive_addr')?errors.first('recive_addr'):'输入收货人地址...'}}</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('recive_addr_info')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'is-danger': errors.has('recive_addr_info') }" name="recive_addr_info" type="text" placeholder="输入收货人详细地址" v-model="order.recive_addr_info">
                                        <label for="recive_addr_info">详细地址<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('recive_addr_info')?errors.first('recive_addr_info'):'输入收货人详细地址...'}}</span>
                                    </div>
                                </div>
                            </div>

                            <h5 class="form-section"><i class="fa fa-truck"></i> 配送信息</h5>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-group form-md-radios">
                                        <label for="form_control_1">配送方式</label>
                                        <div class="md-radio-inline">
                                            <div class="md-radio">
                                                <input type="radio" id="checkbox2_8" name="dispatching_type"  v-model="order.dispatching_type"
                                                       value="dispatching" class="md-radiobtn" checked="checked"/>
                                                <label for="checkbox2_8">
                                                    <span></span>
                                                    <span class="check"></span>
                                                    <span class="box"></span> 配送 </label>
                                            </div>
                                            <div class="md-radio">
                                                <input type="radio" id="checkbox2_9" name="dispatching_type"  v-model="order.dispatching_type"
                                                       value="since" class="md-radiobtn"/>
                                                <label for="checkbox2_9">
                                                    <span></span>
                                                    <span class="check"></span>
                                                    <span class="box"></span> 自提 </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('send_time')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'date-picker':true, 'is-danger': errors.has('send_time') }" name="send_time" type="text" placeholder="选择预计发货时间" v-model="order.send_time" data-date-format="yyyy/mm/dd">
                                        <label for="send_time">预计发货时间<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('send_time')?errors.first('send_time'):'选择预计发货时间...'}}</span>
                                    </div>
                                </div>


                                <div class="col-md-3">
                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('recive_time')}">
                                        <input v-validate="'required'" :class="{'form-control': true, 'date-picker':true, 'is-danger': errors.has('recive_time') }" name="recive_time" type="text" placeholder="选择要求到达时间" v-model="order.recive_time" data-date-format="yyyy/mm/dd">
                                        <label for="recive_time">要求到达时间<span class="required">*</span></label>
                                        <span class="help-block">{{ errors.has('recive_time')?errors.first('recive_time'):'选择要求到达时间...'}}</span>
                                    </div>
                                </div>
                                
                            </div>

                            <h5 class="form-section"><i class="fa fa-tasks"></i> 货物信息</h5>
                            <div class="row ">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <div class="mt-repeater" id="goods_list">
                                            <div v-for="(good, index) in order.goods" class="row">
                                                
                                                <div class="col-md-3">
                                                    <div :class="{'form-group':true, 'form-md-line-input':true, 'has-error':errors.has('goods_name')}">
                                                        <input v-validate="'required'" :class="{'form-control': true, 'is-danger': errors.has('recive_addr_info') }" name="goods_name" type="text" placeholder="输入货物名称" v-model="good.name">
                                                        <label for="goods_name">货物名称<span class="required">*</span></label>
                                                        <span class="help-block">{{ errors.has('goods_name')?errors.first('goods_name'):'输入货物名称...'}}</span>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <label class="control-label">大小尺寸</label>
                                                    <input type="text" placeholder="" class="form-control" :name="'goods['+index+'].size'"  v-model="good.size"/></div>
                                                <div class="col-md-2">
                                                    <label class="control-label">总重量</label>
                                                    <input type="text" placeholder="单位：吨" class="form-control" :name="'goods['+index+'].weight'"  v-model="good.weight"/>
                                                </div>
                                                <div class="col-md-3">
                                                    <label class="control-label">备注</label>
                                                    <textarea class="form-control" :name="'goods['+index+'].remark'"  v-model="good.remark"
                                                              rows="3"></textarea></div>
                                                <div class="col-md-1">
                                                    <label class="control-label">&nbsp;</label>
                                                    <a href="javascript:;" class="btn btn-danger form-control" v-on:click="deleteGoods(index)">
                                                        <i class="fa fa-close"></i> 删除
                                                    </a>
                                                </div>
                                            </div>
                                            <hr/>
                                            <a href="javascript:;" class="btn btn-info mt-repeater-add" v-on:click="addNewGoods">
                                                <i class="fa fa-plus"></i> 增加货物</a>
                                            <br/>
                                            <br/>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div class="form-actions right" v-on:click="submitOrder">
                            <button class="btn blue">
                                <i class="fa fa-check"></i> 确定创建
                            </button>
                        </div>
                    </div>
                    <!-- END FORM-->
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END PAGE BASE CONTENT -->

<template id="goods_template">

		
		
</template>

<!-- BEGIN CORE PLUGINS -->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/jquery.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap/js/bootstrap.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/js.cookie.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/jquery.blockui.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js"
        type="text/javascript"></script>
<!-- END CORE PLUGINS -->
<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/scripts/app.min.js"
        type="text/javascript"></script>
<!-- END THEME GLOBAL SCRIPTS -->
<!-- BEGIN THEME LAYOUT SCRIPTS -->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/layout4/scripts/layout.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/layout4/scripts/demo.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/global/scripts/quick-sidebar.min.js"
        type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/layouts/global/scripts/quick-nav.min.js"
        type="text/javascript"></script>
<!-- END THEME LAYOUT SCRIPTS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/moment.min.js"
        type="text/javascript"></script>
    
<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-sweetalert/sweetalert.min.js"
        type="text/javascript"></script>
<!-- END PAGE LEVEL PLUGINS -->

<!--
<script th:src="@{/js/form-validation-role.min.js}" type="text/javascript"></script>
-->

    <!--日期选择器插件-->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js" type="text/javascript"></script>
    <!--城市插件-->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/city-picker/js/city-picker.data.js" type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/metronic_v4.7.5/assets/global/plugins/city-picker/js/city-picker.js" type="text/javascript"></script>
    <!--vue.js插件-->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/vue/vue2.3.4.js" type="text/javascript"></script>
    <!--vue restful通信插件-->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/vue/vue-resource1.3.4.js" type="text/javascript"></script>
    <!--vue 表单验证插件-->
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/vue/vee-validate/vee-validate.js" type="text/javascript"></script>
<script src="http://avatarcn-html.oss-cn-hangzhou.aliyuncs.com/vue/vee-validate/locale/zh_CN.js" type="text/javascript"></script>



<script>
    
    $().ready(function(){
        $(".date-picker").datepicker({
            language: "zh-CN"
        });
        
        $('#target').citypicker();
    });
    

    const config = {
        errorBagName: 'errors', // change if property conflicts.
        delay: 0,
        locale: 'zh_CN',
        messages: null,
        strict: true
    };
    
    Vue.use(VeeValidate,config);
    new Vue({
      el: '#form',
      data: {
          order:{
              send_name:"",
              send_phone:"",
              send_addr:"",
              send_addr_info:"",
              recive_phone:"",
              recive_addr:"",
              recive_addr_info:"",
              dispatching_type:"dispatching",
              send_time:"",
              recive_time:"",
              goods: [
                  {
                      name:"",
                      size:"",
                      weight:"",
                      remark:""
                  }
              ]
          }
      },
      methods: {
        addNewGoods: function () {
            this.order.goods.push({name:"",size:"",weight:"",remark:""});
        },
        deleteGoods: function (index) {
            this.order.goods.splice(index,1);  
        },
        submitOrder: function () {
            var resouce = this.$resource('http://localhost/v1/order/api/customer');
            var orders = this.order;
            this.$validator.validateAll().then(function(result){
               if(result)
                {
                    var fd = new FormData();
                    fd.append('send_name',orders.send_name);
                    fd.append('send_phone',orders.send_phone);
                    fd.append('send_addr',orders.send_addr);
                    fd.append('send_addr_info',orders.send_addr_info);
                    fd.append('recive_phone',orders.recive_phone);
                    fd.append('recive_addr',orders.recive_addr);
                    fd.append('recive_addr_info',orders.recive_addr_info);
                    fd.append('dispatching_type',orders.dispatching_type);
                    fd.append('send_time',orders.send_time);
                    fd.append('recive_time',orders.recive_time);
                    fd.append('goods',JSON.stringify(orders.goods));

                    resouce.save(fd).then(
                        function (response){
                            var result = $.parseJSON(response.bodyText);
                            if(result.success)
                                {
                                    alert('成功！');
                                }
                        },
                        function (error){
                            console.log(error);
                        }
                    );
                }
            });
            
            
        }
      }
    })
</script>
</html>